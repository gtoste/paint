(()=>{"use strict";var t;!function(t){t[t.brush=0]="brush",t[t.rectangle=1]="rectangle",t[t.circle=2]="circle",t[t.line=3]="line"}(t||(t={}));const o=function(){function t(t,o){this.positions=[],this.color=t,this.ctx=o,this.positions=[]}return t.prototype.add=function(t,o){var e={last_pos:t,pos:o};this.positions.push(e)},t.prototype.draw=function(){for(var t=0;t<this.positions.length;t++){var o=this.positions[t].last_pos,e=this.positions[t].pos;this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.ctx.lineCap="round",this.ctx.moveTo(o.x,o.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke()}},t}(),e=function(){function t(){}return t.prototype.draw=function(){},t}();var s=function(){function s(o){var e=this;this.canvas=o,this.ctx=o.getContext("2d"),this.resize(),document.body.onresize=this.resize,this.color="red",this.r=10,this.last_pos=null,this.history=[],o.onmousedown=function(t){e.bindDraw(t)},o.onmouseup=function(){e.unbindDraw()},this.mode=t.brush,this.proportions=!1,this.fill=!1}return s.prototype.resize=function(){var t=2*document.body.offsetWidth/3;this.canvas.width=t,this.canvas.height=9/16*t},s.prototype.getMousePos=function(t){var o=this.canvas.getBoundingClientRect(),e=this.canvas.width/o.width,s=this.canvas.height/o.height;return{x:(t.clientX-o.left)*e,y:(t.clientY-o.top)*s}},s.prototype.bindDraw=function(e){var s=this;switch(this.mode){case t.brush:var n=new o(this.color,this.ctx);this.canvas.onmousemove=function(t){null==s.last_pos&&(s.last_pos=s.getMousePos(t));var o=s.getMousePos(t);n.add(s.last_pos,o),s.draw(s.last_pos,o)},this.history.push(n);break;case t.rectangle:this.last_pos=this.getMousePos(e),this.canvas.onmousemove=function(t){var o=s.getMousePos(t);s.draw(s.last_pos,o)}}},s.prototype.unbindDraw=function(){this.canvas.onmousemove=null,this.last_pos=null},s.prototype.draw=function(o,e){switch(this.mode){case t.brush:this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.ctx.lineCap="round",this.ctx.moveTo(o.x,o.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke(),this.last_pos=e;break;case t.rectangle:this.ctx.beginPath(),this.ctx.strokeStyle=this.color,this.ctx.rect(o.x,o.y,e.x-o.x,e.y-o.y),this.ctx.stroke()}},s.prototype.clear=function(){var t=document.body.offsetWidth;this.ctx.clearRect(0,0,t,9/16*t),this.history.push(new e)},s.prototype.undo=function(){var t=document.body.offsetWidth;this.ctx.clearRect(0,0,t,9/16*t),this.history.pop();for(var o=0;o<this.history.length;o++)this.history[o].draw()},s.prototype.setMode=function(t){this.mode=t},s.prototype.getMode=function(){return this.mode},s.prototype.setColor=function(t){this.color=t},s.prototype.setProportions=function(){this.proportions=!this.proportions},s.prototype.getProportions=function(){return this.proportions},s.prototype.setFill=function(){this.fill=!this.fill},s.prototype.getFill=function(){return this.fill},s}(),n=document.getElementById("canvas"),i=(document.getElementById("option_download"),document.getElementById("options_clear")),c=document.getElementById("options_previous"),r=document.getElementById("options_color_red"),l=document.getElementById("options_color_blue"),h=document.getElementById("options_color_green"),u=document.getElementById("options_color_yellow"),a=document.getElementById("color_picker"),d=document.getElementById("options_brush"),p=document.getElementById("options_rectangle"),f=document.getElementById("options_circle"),y=document.getElementById("options_line"),m=document.getElementById("options_proportions"),g=document.getElementById("options_fill"),v=new s(n),x=r,_=d;r.classList.add("selected"),d.classList.add("selected");var b=function(t,o){v.setColor(t),x.classList.remove("selected"),o.classList.add("selected"),x=o},k=function(t,o){v.setMode(t),_.classList.remove("selected"),o.classList.add("selected"),_=o};r.onclick=function(){b("red",r)},l.onclick=function(){b("blue",l)},h.onclick=function(){b("green",h)},u.onclick=function(){b("yellow",u)},a.onclick=function(){b(a.value,a.parentElement)},d.onclick=function(){k(t.brush,d)},p.onclick=function(){k(t.rectangle,p)},f.onclick=function(){k(t.circle,f)},y.onclick=function(){k(t.line,y)},m.onclick=function(){v.getProportions()?m.classList.remove("selected"):m.classList.add("selected"),v.setProportions()},g.onclick=function(){v.getFill()?g.classList.remove("selected"):g.classList.add("selected"),v.setFill()},c.onclick=function(){v.undo()},i.onclick=function(){v.clear()}})();